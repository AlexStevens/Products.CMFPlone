Personal Preferences Account Panel
==================================

Viewing the account panel
-------------------------

Viewing the account panel should not be possible for anonymous users:

    >>> self.browser.open('http://nohost/plone/@@personal_preferences')
    >>> 'Please log in' in self.browser.contents
    True

So let's register as member and login:

    >>> self.loginAsMember()

Now we should be able to access the account panel:

    >>> self.browser.open('http://nohost/plone/@@personal_preferences')
    >>> 'Please log in' in self.browser.contents
    False
    >>> self.browser.url.endswith('@@personal_preferences')
    True

We have two controls, one for the start page and one for the language:

    >>> self.browser.getControl(name='form.start_page').value
    ''
    >>> self.browser.getControl(name='form.language').value
    ['']

Click the save button without making any changes:

    >>> self.browser.getControl(name="form.actions.save").click()
    >>> 'Please log in' in self.browser.contents
    False
    >>> self.browser.url.endswith('@@personal_preferences')
    True

It is impossible to chack the "No changes made." status message
as we always have a value selected for the languages widget:

    >>> 'No changes made.' in self.browser.contents
    False

Though we should have a message:

    >>> 'Changes saved.' in self.browser.contents
    True

Now we click the cancel button:

    >>> self.browser.getControl(name="form.actions.cancel").click()
    >>> self.browser.url.endswith('@@personal_preferences')
    True

There should be no changes at all:

    >>> 'Changes canceled.' in self.browser.contents
    True

Modifying values
----------------

    >>> self.browser.open('http://nohost/plone/@@personal_preferences')
    >>> self.browser.getControl(name='form.start_page').value = '/Members/user'
    >>> self.browser.getControl(name='form.language').value = ['en']
    >>> self.browser.getControl(name="form.actions.save").click()
    >>> 'Changes saved.' in self.browser.contents
    True

Verify, that the settings have actually been changed:

    >>> self.member.getProperty('start_page', '')
    '/Members/user'
    >>> self.member.getProperty('language', '')
    ['en']

And that the form still has the according values:

    >>> self.browser.open('http://nohost/plone/@@personal_preferences')
    >>> self.browser.getControl(name='form.start_page').value
    '/Members/user'
    >>> self.browser.getControl(name='form.language').value
    ['en']

