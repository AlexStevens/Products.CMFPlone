Calendar control panel
======================

First some initial setup code:

    >>> from Products.Five.testbrowser import Browser
    >>> browser = Browser()

    >>> uf = self.portal.acl_users
    >>> uf.userFolderAddUser('root', 'secret', ['Manager'], [])

    >>> from Products.CMFCore.utils import getToolByName
    >>> ctool = getToolByName(self.portal, 'portal_calendar')

And now log in with an user with the Manager role:

    >>> browser.open('http://nohost/plone/')
    >>> browser.getLink('Log in').click()
    >>> browser.getControl('Login Name').value = 'root'
    >>> browser.getControl('Password').value = 'secret'
    >>> browser.getControl('Log in').click()

Viewing the calendar control panel
----------------------------------

    >>> browser.open('http://nohost/plone/@@calendar-controlpanel.html')
    >>> browser.url
    'http://nohost/plone/@@calendar-controlpanel.html'

Click the save button without making any changes:

    >>> browser.getControl(name="form.actions.save").click()
    >>> browser.url
    'http://nohost/plone/%40%40calendar-controlpanel.html'

We should get a status message:

    >>> 'No changes done.' in browser.contents
    True

Now click the cancel button:

    >>> browser.getControl(name="form.actions.cancel").click()
    >>> browser.url
    'http://nohost/plone/%40%40calendar-controlpanel.html'

There should be still no changes:

    >>> 'Changes canceled.' in browser.contents
    True

Make some changes
-----------------

    >>> browser.open('http://nohost/plone/@@calendar-controlpanel.html')
    >>> browser.url
    'http://nohost/plone/@@calendar-controlpanel.html'

    >>> browser.getControl(name='form.firstweekday').value = ['Sunday']
    >>> browser.getControl(name='form.calendar_types:list').value = ['Event', 'Page']

Click the save button:

    >>> browser.getControl(name="form.actions.save").click()
    >>> browser.url
    'http://nohost/plone/%40%40calendar-controlpanel.html'

We should be informed that something has changed:

    >>> 'Changes saved.' in browser.contents
    True

Make sure the changes have been applied correctly to the tool:

    >>> ctool.calendar_types
    ('Event', 'Document')

    >>> ctool.firstweekday
    6
